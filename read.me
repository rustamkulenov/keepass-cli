References:

https://habr.com/ru/post/346820/

https://github.com/keepassx/keepassx/blob/master/src/format/KeePass2Reader.cpp
https://github.com/keepassxreboot/keepassxc/blob/develop/src/format/KdbxReader.cpp
https://github.com/keepassxreboot/keepassxc/blob/develop/src/format/Kdbx4Reader.cpp
https://gist.github.com/msmuenchen/9318327
https://keepass.info/help/kb/kdbx_4.html

bulding composite key:
https://github.com/keepassxreboot/keepassxc/blob/develop/src/gui/DatabaseOpenWidget.cpp#L263
Get key for HMAC:
https://github.com/keepassxreboot/keepassxc/blob/develop/src/format/KeePass2.cpp#L61

Sample password file (password is Q12345):
example-AES-256-KDF-Q12345.kdbx